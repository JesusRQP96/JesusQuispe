{
  "hash": "280dd238e5f632eb9e5573649611fe43",
  "result": {
    "markdown": "---\ntitle: \"Analisis factorial \"\nsubtitle: \"CFA & EFA\"\ndescription: |\n  Applicacion del analisis factorial integrado\ndate: \"2025-01-01\"\ncategories: [Multivariate analysis,spychometrics,CFA,EFA]\nexecute:\n  message: false\n  warning: false\n---\n\n\n# Analisis confirmatorio\n\n## Carga de paquetes & datos\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lavaan)\nlibrary(psych)\nlibrary(semTools)   #funcion para analisis de resultados,\nlibrary(tidyverse)\nlibrary(devtools)\nlibrary(readxl)\n\n#install.packages(\"skimr\")\nlibrary(skimr) # package\n\n#Improve L& f of tables\nlibrary(pander)\n\nlibrary(rio)\nlibrary(effectsize)\n\ndb_respuesta <- read_excel(\"respuesta.xlsx\")\n```\n:::\n\n\n## Analisis factorial integrado\n\nSe emplea un estrategia en 3 pasos muchas veces empleada que integra el analisis factorial exploratorio y el analisis factorial confirmatorio (otras estrategias solo se emplea uno de los 2):\n\n1)  Explorar la estructura factorial (Evaluacion de supuestos).\n2)  Construir el modelo factorial y evaluar el ajuste(estimacion EFA, CFA, criterios de informacion).\n3)  Evaluar generabilidad (ajustar la muestra en los datos de prueba)\n\n### Evaluacion de Supuestos\n\nLos resultados del modelo EFA, finalmente se validan a travez del modelo CFA, de modo tal que la evaluacion de supuestos de uno corresponde tambien la del otro\n\n#### Supuestos en los datos\n\n##### Datos completos\n\n###### skimr + pander\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(db_respuesta) %>% \npander()\n```\n\n::: {.cell-output-display}\n----------------------------------------------------------------------\n skim_type   skim_variable   n_missing   complete_rate   numeric.mean \n----------- --------------- ----------- --------------- --------------\n  numeric        TSC1            0             1            3.653     \n\n  numeric        TSC2            0             1            3.809     \n\n  numeric        TSC3            0             1            3.732     \n\n  numeric        TSC4            0             1            3.709     \n\n  numeric        TSC5            0             1            3.822     \n\n  numeric         TE1            0             1            4.061     \n\n  numeric         TE2            0             1            4.043     \n\n  numeric         TE3            0             1            4.121     \n\n  numeric         TE4            0             1            4.105     \n\n  numeric         TE5            0             1            3.902     \n\n  numeric         EE1            0             1            3.812     \n\n  numeric         EE2            0             1            3.727     \n\n  numeric         EE3            0             1            3.878     \n\n  numeric         EE4            0             1            3.687     \n\n  numeric         EE5            0             1            3.987     \n\n  numeric         DE1            0             1            3.925     \n\n  numeric         DE2            0             1            3.596     \n\n  numeric         DE3            0             1            3.817     \n\n  numeric        RPA1            0             1            3.933     \n\n  numeric        RPA2            0             1            3.941     \n\n  numeric        RPA3            0             1            3.884     \n\n  numeric        RPA4            0             1            3.869     \n\n  numeric        RPA5            0             1            3.842     \n----------------------------------------------------------------------\n\nTable: Table continues below\n\n \n-------------------------------------------------------------------\n numeric.sd   numeric.p0   numeric.p25   numeric.p50   numeric.p75 \n------------ ------------ ------------- ------------- -------------\n   0.6849         1             3             4             4      \n\n   0.6389         2             3             4             4      \n\n   0.6396         2             3             4             4      \n\n   0.6734         2             3             4             4      \n\n   0.6522         2             3             4             4      \n\n   0.7122         1             4             4             5      \n\n   0.698          2             4             4             5      \n\n   0.7052         1             4             4             5      \n\n   0.6898         1             4             4             5      \n\n   0.7541         1             3             4             4      \n\n   0.7589         1             3             4             4      \n\n   0.8484         1             3             4             4      \n\n   0.828          1             3             4             4      \n\n   0.7959         1             3             4             4      \n\n   0.8105         1             3             4             5      \n\n   0.677          1             4             4             4      \n\n   0.682          1             3             4             4      \n\n   0.6984         1             3             4             4      \n\n   0.8343         1             3             4             5      \n\n   0.8049         1             4             4             4      \n\n   0.7886         1             3             4             4      \n\n   0.7649         1             3             4             4      \n\n   0.7858         1             3             4             4      \n-------------------------------------------------------------------\n\nTable: Table continues below\n\n \n-----------------------------\n numeric.p100   numeric.hist \n-------------- --------------\n      5            ▁▁▆▇▂     \n\n      5            ▁▃▁▇▂     \n\n      5            ▁▅▁▇▁     \n\n      5            ▁▅▁▇▂     \n\n      5            ▁▃▁▇▂     \n\n      5            ▁▁▂▇▃     \n\n      5            ▁▃▁▇▃     \n\n      5            ▁▁▂▇▅     \n\n      5            ▁▁▂▇▃     \n\n      5            ▁▁▃▇▃     \n\n      5            ▁▁▅▇▂     \n\n      5            ▁▁▆▇▃     \n\n      5            ▁▁▅▇▅     \n\n      5            ▁▁▇▇▃     \n\n      5            ▁▁▅▇▅     \n\n      5            ▁▁▂▇▂     \n\n      5            ▁▁▆▇▁     \n\n      5            ▁▁▅▇▂     \n\n      5            ▁▁▅▇▅     \n\n      5            ▁▁▃▇▃     \n\n      5            ▁▁▃▇▃     \n\n      5            ▁▁▃▇▃     \n\n      5            ▁▁▃▇▃     \n-----------------------------\n:::\n:::\n\n\n##### Tamaño muestral\n\nRule of thumb \\> 200 registros\n\n##### Variables cuantitativas\n\nUn primer requerimiento antes de comenzar con el analisis factorial, es determinar el *nivel de medicion*;es decir, si son variables ordinales, cuantitativas, nominales, ya que la estructura de correlacion es la base del analisis factorial de modo tal que dependiendo de nivel de medicion sera necesario emplear una correlacion: pearson,tetracoricas,policoricas.\n\nVariables con similar rango y continuas\n\nPor defecto muchos paquetes en R asumen que son variables cuantitativas, variables obsersables con \\>5 niveles.\n\n##### A) Validar normalidad\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  db.longer_normal <-   db_respuesta                                                                  |> \n                        select(where(is.numeric))                                                     |> \n                        pivot_longer(cols = everything(), names_to = \"Variable_obs\", values_to = \"Valor\") \n\n  db.longer_normal     |> \n  ggplot(aes(x = Valor)) +\n  geom_histogram(bins = 30, fill = \"steelblue\", color = \"white\", alpha = 0.7) +\n  facet_wrap(~ Variable_obs, scales = \"free\") +  # Crear subgráficos por variable\n  theme_minimal() +\n  labs(title = \"Distribución de Variables Numéricas\", x = \"Variable Obs\", y = \"Frecuencia\")\n```\n\n::: {.cell-output-display}\n![](analisis-confirmatorio_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n##### B)Validar normalidad :Metricas estadisticas\n\n-   Hay reglas of generales(rules of thumb), que establecen que ambos estadisticos no deben separar 3\n\n::: panel-tabset\n###### e1071\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(e1071)\n\ntbl.stats   <-  db.longer_normal                                            |>\n                group_by(Variable_obs)                                      |>\n                summarise(\n                  skewness = e1071::skewness(Valor, na.rm = TRUE),\n                  kurtosis = e1071::kurtosis(Valor, na.rm = TRUE)\n                )\nlibrary(gt)  \n  \n  \n  tbl.stats                             |>\n  gt()                                  |>\n  data_color(\n    columns = vars(skewness),\n    colors = scales::col_bin(\n      bins = c(-Inf, 0, Inf),\n      palette = c(\"coral\", \"aliceblue\")\n    )\n  )                                     |>\n  data_color(\n    columns = vars(kurtosis),\n    colors = scales::col_bin(\n      bins = c(-Inf, 0, Inf),\n      palette = c(\"coral\", \"aliceblue\")\n    )\n  )                                     |>\n  tab_header(\n    title = \"Asimetría y Curtosis por Variable\"\n  )\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"rcatbllzog\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#rcatbllzog table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#rcatbllzog thead, #rcatbllzog tbody, #rcatbllzog tfoot, #rcatbllzog tr, #rcatbllzog td, #rcatbllzog th {\n  border-style: none;\n}\n\n#rcatbllzog p {\n  margin: 0;\n  padding: 0;\n}\n\n#rcatbllzog .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#rcatbllzog .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#rcatbllzog .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#rcatbllzog .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#rcatbllzog .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#rcatbllzog .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#rcatbllzog .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#rcatbllzog .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#rcatbllzog .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#rcatbllzog .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#rcatbllzog .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#rcatbllzog .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#rcatbllzog .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#rcatbllzog .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#rcatbllzog .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rcatbllzog .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#rcatbllzog .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#rcatbllzog .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#rcatbllzog .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rcatbllzog .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#rcatbllzog .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rcatbllzog .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#rcatbllzog .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rcatbllzog .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#rcatbllzog .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#rcatbllzog .gt_left {\n  text-align: left;\n}\n\n#rcatbllzog .gt_center {\n  text-align: center;\n}\n\n#rcatbllzog .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#rcatbllzog .gt_font_normal {\n  font-weight: normal;\n}\n\n#rcatbllzog .gt_font_bold {\n  font-weight: bold;\n}\n\n#rcatbllzog .gt_font_italic {\n  font-style: italic;\n}\n\n#rcatbllzog .gt_super {\n  font-size: 65%;\n}\n\n#rcatbllzog .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#rcatbllzog .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#rcatbllzog .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#rcatbllzog .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#rcatbllzog .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#rcatbllzog .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#rcatbllzog .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"3\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Asimetría y Curtosis por Variable</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Variable_obs\">Variable_obs</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"skewness\">skewness</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_right\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"kurtosis\">kurtosis</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">DE1</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.52605215</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">1.24559696</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">DE2</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.21897007</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.63925394</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">DE3</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.13677255</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.01245932</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">EE1</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.34581133</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.23143832</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">EE2</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.36964012</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.12256023</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">EE3</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.31280354</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.39901657</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">EE4</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.03410964</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.40742547</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">EE5</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.42732927</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.26944283</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">RPA1</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.59305403</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.50420600</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">RPA2</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.78552074</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">1.22272528</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">RPA3</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.58790017</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.74890573</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">RPA4</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.47810685</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.33329229</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">RPA5</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.53468885</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.67055640</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TE1</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.46692932</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.37701716</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TE2</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.22002197</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.44900737</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TE3</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.72100623</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">1.60041195</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TE4</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.47367810</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.50711668</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TE5</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.41165968</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.16474956</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TSC1</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.09242437</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #F0F8FF; color: #000000;\">0.06296766</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TSC2</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.07293765</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.14123339</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TSC3</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.16580865</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.01842834</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TSC4</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.02578558</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.25212689</td></tr>\n    <tr><td headers=\"Variable_obs\" class=\"gt_row gt_left\">TSC5</td>\n<td headers=\"skewness\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.09955242</td>\n<td headers=\"kurtosis\" class=\"gt_row gt_right\" style=\"background-color: #FF7F50; color: #000000;\">-0.12934441</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n\n###### skimr\n\n\n::: {.cell}\n\n```{.r .cell-code}\nskim(db_respuesta)\n```\n\n::: {.cell-output-display}\nTable: Data summary\n\n|                         |             |\n|:------------------------|:------------|\n|Name                     |db_respuesta |\n|Number of rows           |876          |\n|Number of columns        |23           |\n|_______________________  |             |\n|Column type frequency:   |             |\n|numeric                  |23           |\n|________________________ |             |\n|Group variables          |None         |\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate| mean|   sd| p0| p25| p50| p75| p100|hist  |\n|:-------------|---------:|-------------:|----:|----:|--:|---:|---:|---:|----:|:-----|\n|TSC1          |         0|             1| 3.65| 0.68|  1|   3|   4|   4|    5|▁▁▆▇▂ |\n|TSC2          |         0|             1| 3.81| 0.64|  2|   3|   4|   4|    5|▁▃▁▇▂ |\n|TSC3          |         0|             1| 3.73| 0.64|  2|   3|   4|   4|    5|▁▅▁▇▁ |\n|TSC4          |         0|             1| 3.71| 0.67|  2|   3|   4|   4|    5|▁▅▁▇▂ |\n|TSC5          |         0|             1| 3.82| 0.65|  2|   3|   4|   4|    5|▁▃▁▇▂ |\n|TE1           |         0|             1| 4.06| 0.71|  1|   4|   4|   5|    5|▁▁▂▇▃ |\n|TE2           |         0|             1| 4.04| 0.70|  2|   4|   4|   5|    5|▁▃▁▇▃ |\n|TE3           |         0|             1| 4.12| 0.71|  1|   4|   4|   5|    5|▁▁▂▇▅ |\n|TE4           |         0|             1| 4.11| 0.69|  1|   4|   4|   5|    5|▁▁▂▇▃ |\n|TE5           |         0|             1| 3.90| 0.75|  1|   3|   4|   4|    5|▁▁▃▇▃ |\n|EE1           |         0|             1| 3.81| 0.76|  1|   3|   4|   4|    5|▁▁▅▇▂ |\n|EE2           |         0|             1| 3.73| 0.85|  1|   3|   4|   4|    5|▁▁▆▇▃ |\n|EE3           |         0|             1| 3.88| 0.83|  1|   3|   4|   4|    5|▁▁▅▇▅ |\n|EE4           |         0|             1| 3.69| 0.80|  1|   3|   4|   4|    5|▁▁▇▇▃ |\n|EE5           |         0|             1| 3.99| 0.81|  1|   3|   4|   5|    5|▁▁▅▇▅ |\n|DE1           |         0|             1| 3.92| 0.68|  1|   4|   4|   4|    5|▁▁▂▇▂ |\n|DE2           |         0|             1| 3.60| 0.68|  1|   3|   4|   4|    5|▁▁▆▇▁ |\n|DE3           |         0|             1| 3.82| 0.70|  1|   3|   4|   4|    5|▁▁▅▇▂ |\n|RPA1          |         0|             1| 3.93| 0.83|  1|   3|   4|   5|    5|▁▁▅▇▅ |\n|RPA2          |         0|             1| 3.94| 0.80|  1|   4|   4|   4|    5|▁▁▃▇▃ |\n|RPA3          |         0|             1| 3.88| 0.79|  1|   3|   4|   4|    5|▁▁▃▇▃ |\n|RPA4          |         0|             1| 3.87| 0.76|  1|   3|   4|   4|    5|▁▁▃▇▃ |\n|RPA5          |         0|             1| 3.84| 0.79|  1|   3|   4|   4|    5|▁▁▃▇▃ |\n:::\n:::\n\n\n###### pysch\n\n\n::: {.cell}\n\n```{.r .cell-code}\npsych::describe(db_respuesta)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     vars   n mean   sd median trimmed  mad min max range  skew kurtosis   se\nTSC1    1 876 3.65 0.68      4    3.62 0.00   1   5     4 -0.09     0.06 0.02\nTSC2    2 876 3.81 0.64      4    3.78 0.00   2   5     3 -0.07    -0.14 0.02\nTSC3    3 876 3.73 0.64      4    3.71 0.00   2   5     3 -0.17    -0.02 0.02\nTSC4    4 876 3.71 0.67      4    3.67 0.00   2   5     3 -0.03    -0.25 0.02\nTSC5    5 876 3.82 0.65      4    3.79 0.00   2   5     3 -0.10    -0.13 0.02\nTE1     6 876 4.06 0.71      4    4.10 0.00   1   5     4 -0.47     0.38 0.02\nTE2     7 876 4.04 0.70      4    4.07 0.00   2   5     3 -0.22    -0.45 0.02\nTE3     8 876 4.12 0.71      4    4.17 0.00   1   5     4 -0.72     1.60 0.02\nTE4     9 876 4.11 0.69      4    4.15 0.00   1   5     4 -0.47     0.51 0.02\nTE5    10 876 3.90 0.75      4    3.92 0.00   1   5     4 -0.41     0.16 0.03\nEE1    11 876 3.81 0.76      4    3.81 0.00   1   5     4 -0.35     0.23 0.03\nEE2    12 876 3.73 0.85      4    3.75 1.48   1   5     4 -0.37     0.12 0.03\nEE3    13 876 3.88 0.83      4    3.91 1.48   1   5     4 -0.31    -0.40 0.03\nEE4    14 876 3.69 0.80      4    3.67 1.48   1   5     4 -0.03    -0.41 0.03\nEE5    15 876 3.99 0.81      4    4.03 1.48   1   5     4 -0.43    -0.27 0.03\nDE1    16 876 3.92 0.68      4    3.93 0.00   1   5     4 -0.53     1.25 0.02\nDE2    17 876 3.60 0.68      4    3.58 1.48   1   5     4 -0.22     0.64 0.02\nDE3    18 876 3.82 0.70      4    3.79 0.00   1   5     4 -0.14     0.01 0.02\nRPA1   19 876 3.93 0.83      4    3.97 1.48   1   5     4 -0.59     0.50 0.03\nRPA2   20 876 3.94 0.80      4    3.99 0.00   1   5     4 -0.79     1.22 0.03\nRPA3   21 876 3.88 0.79      4    3.91 0.00   1   5     4 -0.59     0.75 0.03\nRPA4   22 876 3.87 0.76      4    3.89 0.00   1   5     4 -0.48     0.33 0.03\nRPA5   23 876 3.84 0.79      4    3.86 0.00   1   5     4 -0.53     0.67 0.03\n```\n:::\n:::\n\n\n###### pysch + pander\n\n\n::: {.cell}\n\n```{.r .cell-code}\npsych::describe(db_respuesta) %>% \npander()\n```\n\n::: {.cell-output-display}\n-------------------------------------------------------------------------------\n  &nbsp;    vars    n    mean      sd     median   trimmed    mad    min   max \n---------- ------ ----- ------- -------- -------- --------- ------- ----- -----\n **TSC1**    1     876   3.653   0.6849     4       3.62       0      1     5  \n\n **TSC2**    2     876   3.809   0.6389     4       3.776      0      2     5  \n\n **TSC3**    3     876   3.732   0.6396     4       3.708      0      2     5  \n\n **TSC4**    4     876   3.709   0.6734     4       3.665      0      2     5  \n\n **TSC5**    5     876   3.822   0.6522     4       3.795      0      2     5  \n\n **TE1**     6     876   4.061   0.7122     4       4.098      0      1     5  \n\n **TE2**     7     876   4.043   0.698      4       4.066      0      2     5  \n\n **TE3**     8     876   4.121   0.7052     4       4.174      0      1     5  \n\n **TE4**     9     876   4.105   0.6898     4       4.148      0      1     5  \n\n **TE5**     10    876   3.902   0.7541     4       3.923      0      1     5  \n\n **EE1**     11    876   3.812   0.7589     4       3.815      0      1     5  \n\n **EE2**     12    876   3.727   0.8484     4       3.748    1.483    1     5  \n\n **EE3**     13    876   3.878   0.828      4       3.906    1.483    1     5  \n\n **EE4**     14    876   3.687   0.7959     4       3.672    1.483    1     5  \n\n **EE5**     15    876   3.987   0.8105     4       4.028    1.483    1     5  \n\n **DE1**     16    876   3.925   0.677      4       3.934      0      1     5  \n\n **DE2**     17    876   3.596   0.682      4       3.577    1.483    1     5  \n\n **DE3**     18    876   3.817   0.6984     4       3.795      0      1     5  \n\n **RPA1**    19    876   3.933   0.8343     4       3.974    1.483    1     5  \n\n **RPA2**    20    876   3.941   0.8049     4       3.991      0      1     5  \n\n **RPA3**    21    876   3.884   0.7886     4       3.913      0      1     5  \n\n **RPA4**    22    876   3.869   0.7649     4       3.893      0      1     5  \n\n **RPA5**    23    876   3.842   0.7858     4       3.863      0      1     5  \n-------------------------------------------------------------------------------\n\nTable: Table continues below\n\n \n--------------------------------------------------\n  &nbsp;    range     skew     kurtosis     se    \n---------- ------- ---------- ---------- ---------\n **TSC1**     4     -0.09242   0.06297    0.02314 \n\n **TSC2**     3     -0.07294   -0.1412    0.02159 \n\n **TSC3**     3     -0.1658    -0.01843   0.02161 \n\n **TSC4**     3     -0.02579   -0.2521    0.02275 \n\n **TSC5**     3     -0.09955   -0.1293    0.02204 \n\n **TE1**      4     -0.4669     0.377     0.02406 \n\n **TE2**      3      -0.22      -0.449    0.02358 \n\n **TE3**      4      -0.721      1.6      0.02383 \n\n **TE4**      4     -0.4737     0.5071    0.02331 \n\n **TE5**      4     -0.4117     0.1647    0.02548 \n\n **EE1**      4     -0.3458     0.2314    0.02564 \n\n **EE2**      4     -0.3696     0.1226    0.02866 \n\n **EE3**      4     -0.3128     -0.399    0.02798 \n\n **EE4**      4     -0.03411   -0.4074    0.02689 \n\n **EE5**      4     -0.4273    -0.2694    0.02739 \n\n **DE1**      4     -0.5261     1.246     0.02287 \n\n **DE2**      4      -0.219     0.6393    0.02304 \n\n **DE3**      4     -0.1368    0.01246    0.0236  \n\n **RPA1**     4     -0.5931     0.5042    0.02819 \n\n **RPA2**     4     -0.7855     1.223     0.0272  \n\n **RPA3**     4     -0.5879     0.7489    0.02664 \n\n **RPA4**     4     -0.4781     0.3333    0.02584 \n\n **RPA5**     4     -0.5347     0.6706    0.02655 \n--------------------------------------------------\n:::\n:::\n\n:::\n\n#### Supuestos en la matriz de correlacion\n\n##### Estructura de correlacion\n\nEs necesario validar que existe suficiente correlacion entre las variables observadas,sino no tiene caso si quiera plantear la existencia de factores, para ellos se puede calcular el test de *Bartlett*, el cual testea :\n\nho : Matriz de correlacion es una matriz identidad (0's fuera de la diagonal) h1 : no lo es\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# nobmres de columnas\nvarnames                 <- colnames(db_respuesta)\n\n## Matriz de correlacion \nmtr.corr_resp            <- cor(db_respuesta[,varnames])\n\nmtr.corr_bart_result     <-psych::cortest.bartlett(R=mtr.corr_resp,n = nrow(db_respuesta))\n\nmtr.corr_bart_result$p.value<0.05  # Mucho cuidado con n, dependiende de su dimensiodad varia de significativo o no \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] TRUE\n```\n:::\n:::\n\n\n##### Existe realmente gran correlacion ?\n\n-   Para ello requerimos el kmo que se puede entender como la propocion de la varianza total, explicada por los factores\n\n-   El estado kmo , en particular se establece los siguientes umbrales :\n\n| KMO        | Interpretación |\n|------------|----------------|\n| ≥ 0.90     | Excelente      |\n| 0.80--0.89 | Muy bueno      |\n| 0.70--0.79 | Aceptable      |\n| 0.60--0.69 | Mediocre       |\n| 0.50--0.59 | Pobre          |\n| \\< 0.50    | Inaceptable    |\n\n\n::: {.cell}\n\n```{.r .cell-code}\nKMO_result <- KMO(db_respuesta)\n```\n:::\n\n\n#### Muestra para generalizacion\n\nSe recomienda tener una muestra para probar los resultados del modelo factorial, al respecto :\n\n-   para calcular el modelo factorial : n(tamaño muestra) = 5\\*numero de parametros\n-   considerar tener una muestra de testeo/ evaluacion para extrapolar/generalizar resultados : 2\\*n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# tamaño de muestra mitad\nmitad_muestra     <- nrow(db_respuesta)/2\n\nset.seed(19)\n\n## Vector para marcar datos\nvc_marca          <- sample(c(rep(\"model.building\",mitad_muestra),\n                         rep(\"holdout\",mitad_muestra)\n                         ))\n\n## Dividir el vecto x, segun grupos definidos en el vector y \n\ndb_model.build_list   <- split(db_respuesta,vc_marca)\n\n\ndb_train              <-db_model.build_list$model.building\ndb_test               <-db_model.build_list$holdout\n```\n:::\n\n\n## EFA : Analisis factorial exploratorio\n\n-   Parte de un supuesto clave: *Existen los factores, pero no se saben cuantos son ni que variables observables lo componen*\n\n-   Puede ser realizada con 2 metodos, que no necesariamente se menoscaban, de hecho se complementan :\n\na)  Analisis paralelo : Para detectar el numero de factores(ejm constructos)\nb)  Analisis de ajuste : Para detectar el ajuste del modelo con el numero de factores decidido en a) se puede calcular criterios de informacion ejm BIC\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparalel_results <- fa.parallel(x =db_train,fa=\"fa\")\n```\n\n::: {.cell-output-display}\n![](analisis-confirmatorio_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nParallel analysis suggests that the number of factors =  5  and the number of components =  NA \n```\n:::\n\n```{.r .cell-code}\n# cargas factoriales : representan las correlaciones entre las variables obser y el factor latente, si los datos \n# estuvieran estadarizados\n\nvalue.factor       <- paralel_results$fa.values    # factorial loadins\nvalue.factor.simil <- paralel_results$fa.sim\nn.factor           <- 1:length(value.factor)       # numero de factores\n\nscreen.data  <- tibble(loading       = value.factor, \n                       loading_simul = value.factor.simil,\n                       n_factor      = n.factor)\n```\n:::\n\n\n::: panel-tabset\n### Screen plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Idealmente se espera cargas superior a 0.5 (gpt)\nscreen.data                                                     |>\nggplot(aes(n.factor,value.factor))                              +\ngeom_line(size = 1, \n            color = \"lightblue\")                                +\ngeom_hline(yintercept = 0.5, linetype = \"dashed\",color = \"red\") +\ngeom_point(color=\"cornflowerblue\", \n             size = 2, \n             alpha=.8)                                          +\ntheme_bw()                                                      +\nxlab(\"Numero de factores\")                                      +\nylab(\"carga factorial\")\n```\n\n::: {.cell-output-display}\n![](analisis-confirmatorio_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n### Analisis paralelo\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Analisis paralelo\nscreen.data                        |>\nggplot() +\ngeom_line(aes(n.factor,value.factor),\n            size = 1, \n            color = \"lightblue\")   +\ngeom_point(aes(n.factor,value.factor),\n             color=\"cornflowerblue\", \n             size = 2, \n             alpha=.8)             +\ngeom_line(aes(n.factor,value.factor.simil),\n            size = 1, \n            color = \"darkred\")   +\ngeom_point(aes(n.factor,value.factor.simil),\n             color=\"darkred\", \n             size = 2, \n             alpha=.8)             +\nggtitle(\"Analisis paralelo\")       +\ntheme_bw()                         +\nxlab(\"Numero de factores\")         +\nylab(\"carga factorial\")\n```\n\n::: {.cell-output-display}\n![](analisis-confirmatorio_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n:::\n\nEsta metodologia solo dice un numero plausible de factores, mas no el numero final(lo mejor es considerar el rango que lo limita) , el numero final de factores debe ser decidido finalmente en base a : *la interpretabilidad* y el *ajuste*\n\n### Estimacion\n\nLa varianza de los items tiene 3 componentes : varianza compartida, especifica, y varianza del error - comunalidad,especificidad y varianza residual .\n\nPara estimar un modelo asi se debe especificar: \\* El numero de factores \\* El metodo de estimacion \\* la rotacion de la matriz\n\nAsi para estimar el modelo hay 3 principales tecnicas: \\* ML \\* PCA \\* PAF\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults.efa <- lavaan::efa(data      = db_train,\n                           nfactors  = 4:6,     # - el numero otorgado por el analisis paralelo otorga\n                                                #   el rango, el cual seria le numero de factores adecuado.\n                           rotation  = \"geomin\",# - se escoge este metodo de rotacion xq permite que haya correlacion\n                                                # entre factores y tiene sentido pues se habla de constructos educativos\n                           estimator =\"MLR\",    # - Preferible metodo de estimacion al ML, por posibles violaciones del\n                                                # supuesto de normalidad\n                           meanstructure = TRUE)\n```\n:::\n\n\n#### Criterios de informacion\n\nDeacuerdo la metricas de los criterios de criterios de informacion queda claro que el mejor terminar ajustando es el modelo de 5 factores\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsort(lavaan::fitmeasures(results.efa)[\"bic\",])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nnfactors = 5 nfactors = 4 nfactors = 6 \n    18142.38     18167.49     18189.29 \n```\n:::\n:::\n\n\n#### Cargas factoriales\n\nel paquete lavaan te otorga las cargas estandarizadas de modo tal que representarian la correlacion entre la variable observada y el factor\n\n\n::: {.cell}\n\n```{.r .cell-code}\nresults.efa$nf5\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n         f1      f2      f3      f4      f5 \nTSC1  0.584*                       *      .*\nTSC2  0.487*                       *      .*\nTSC3  0.637*                      .*       *\nTSC4  0.578*      .*              .*       *\nTSC5  0.547*                              . \nTE1           0.728*              .         \nTE2       .   0.672*                        \nTE3           0.708*      .                 \nTE4           0.651*              .*        \nTE5           0.337*      .*      .*        \nEE1               .   0.469*      .         \nEE2       .*          0.689*                \nEE3                   0.768*                \nEE4       .*          0.732*              . \nEE5               .   0.479*      .*        \nDE1                  -0.353*  0.744*      . \nDE2               .*          0.821*        \nDE3                       .*  0.755*        \nRPA1                                  0.851*\nRPA2                                  0.906*\nRPA3                                  0.624*\nRPA4                      .       .   0.350*\nRPA5                      .       .   0.338*\n```\n:::\n:::\n\n\n### Modelo bayesiano\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndb_train_sumas <- db_train %>%\n                mutate(\n                  # Aplicamos across con una expresión lógica para cada grupo\n                  TSC = rowSums(across(matches(\"^TSC\\\\d+\")), na.rm = TRUE),\n                  EE  = rowSums(across(matches(\"^TE\\\\d+\")),  na.rm = TRUE),\n                  TE  = rowSums(across(matches(\"^EE\\\\d+\")),  na.rm = TRUE),\n                  DE  = rowSums(across(matches(\"^DE\\\\d+\")),  na.rm = TRUE),\n                  RPA = rowSums(across(matches(\"^RPA\\\\d+\")), na.rm = TRUE)\n                )\n\n\n#install.packages(\"BayesFM\")\nlibrary(\"BayesFM\")\n\n# specify model\nmodel <- c(                                        # X1 covariate in all equations\n            paste0('TSC',' ~ ','TSC',1:5),         # X2 covariate for Y1-Y5 only\n            paste0('TE',' ~ ','TE',6:10),          # X3 covariate for Y6-Y10 only\n            paste0('EE',' ~ ','EE',11:15))         # X4 covariate for Y11-Y15 only\n\nmodel <- lapply(model, as.formula) # make list of formulas\n\n# run MCMC sampler, post process and summarize\nmcmc <- befa(model, data = db_train, Kmax = 5, iter = 1000)\n```\n:::\n\n\n## CFA : Analisis factorial integrado\n\nEste analisis pone a prueba la estructura establecida, para ello usamos la sintaxis lavaan de modelo, tal que asi:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCFA_model <- '\n  # Regressing items on factors,ejm el componente TSC es medido por TSC1 + TSC2 + TSC3 + TSC5\n  TSC =~ TSC1 + TSC2 + TSC3 + TSC5\n  TE  =~ TE1  + TE2  + TE3  + TE5\n  EE  =~ EE1  + EE2  + EE3  + EE4\n  DE  =~ DE1  + DE2  + DE3\n  RPA =~ RPA1 + RPA2 + RPA3 + RPA4\n\n  # Se permite correlacion entre factores\n  TSC ~~ TE\n  TSC ~~ EE\n  TSC ~~ DE\n  TSC ~~ RPA\n\n  TE ~~ EE\n  TE ~~ DE\n  TE ~~ RPA\n\n  EE ~~ DE\n  EE ~~ RPA\n\n  DE ~~ RPA\n'\n\nCFA.results.train <- cfa( model         = CFA_model,\n                         data          = db_train,\n                         estimator     = \"MLR\",\n                         std.lv        = TRUE,\n                         meanstructure = TRUE)\n```\n:::\n\n\n### Analisis de resultados cfa\n\n-   std.all Corresponde a las cargas factoriales de cada variable observable en cada contructo\n\n::: panel-tabset\n#### A) Default\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# referenica : https://www.youtube.com/watch?v=GO5lCfHiFzE***\n\nsummary(CFA.results.train,standardized=T,fit.measures=T)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlavaan 0.6-19 ended normally after 35 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        67\n\n  Number of observations                           438\n\nModel Test User Model:\n                                              Standard      Scaled\n  Test Statistic                               352.092     318.841\n  Degrees of freedom                               142         142\n  P-value (Chi-square)                           0.000       0.000\n  Scaling correction factor                                  1.104\n    Yuan-Bentler correction (Mplus variant)                       \n\nModel Test Baseline Model:\n\n  Test statistic                              4069.230    3549.780\n  Degrees of freedom                               171         171\n  P-value                                        0.000       0.000\n  Scaling correction factor                                  1.146\n\nUser Model versus Baseline Model:\n\n  Comparative Fit Index (CFI)                    0.946       0.948\n  Tucker-Lewis Index (TLI)                       0.935       0.937\n                                                                  \n  Robust Comparative Fit Index (CFI)                         0.950\n  Robust Tucker-Lewis Index (TLI)                            0.939\n\nLoglikelihood and Information Criteria:\n\n  Loglikelihood user model (H0)              -7277.376   -7277.376\n  Scaling correction factor                                  1.177\n      for the MLR correction                                      \n  Loglikelihood unrestricted model (H1)      -7101.330   -7101.330\n  Scaling correction factor                                  1.128\n      for the MLR correction                                      \n                                                                  \n  Akaike (AIC)                               14688.751   14688.751\n  Bayesian (BIC)                             14962.260   14962.260\n  Sample-size adjusted Bayesian (SABIC)      14749.636   14749.636\n\nRoot Mean Square Error of Approximation:\n\n  RMSEA                                          0.058       0.053\n  90 Percent confidence interval - lower         0.051       0.046\n  90 Percent confidence interval - upper         0.066       0.061\n  P-value H_0: RMSEA <= 0.050                    0.040       0.224\n  P-value H_0: RMSEA >= 0.080                    0.000       0.000\n                                                                  \n  Robust RMSEA                                               0.056\n  90 Percent confidence interval - lower                     0.048\n  90 Percent confidence interval - upper                     0.064\n  P-value H_0: Robust RMSEA <= 0.050                         0.110\n  P-value H_0: Robust RMSEA >= 0.080                         0.000\n\nStandardized Root Mean Square Residual:\n\n  SRMR                                           0.044       0.044\n\nParameter Estimates:\n\n  Standard errors                             Sandwich\n  Information bread                           Observed\n  Observed information based on                Hessian\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n  TSC =~                                                                \n    TSC1              0.428    0.029   14.606    0.000    0.428    0.657\n    TSC2              0.430    0.028   15.320    0.000    0.430    0.692\n    TSC3              0.396    0.033   11.909    0.000    0.396    0.628\n    TSC5              0.486    0.029   16.492    0.000    0.486    0.726\n  TE =~                                                                 \n    TE1               0.567    0.034   16.507    0.000    0.567    0.789\n    TE2               0.519    0.027   19.357    0.000    0.519    0.745\n    TE3               0.538    0.039   13.883    0.000    0.538    0.788\n    TE5               0.479    0.041   11.774    0.000    0.479    0.649\n  EE =~                                                                 \n    EE1               0.560    0.035   16.046    0.000    0.560    0.739\n    EE2               0.664    0.033   19.879    0.000    0.664    0.802\n    EE3               0.645    0.035   18.492    0.000    0.645    0.786\n    EE4               0.612    0.035   17.698    0.000    0.612    0.760\n  DE =~                                                                 \n    DE1               0.444    0.042   10.595    0.000    0.444    0.665\n    DE2               0.446    0.040   11.159    0.000    0.446    0.640\n    DE3               0.537    0.036   14.749    0.000    0.537    0.738\n  RPA =~                                                                \n    RPA1              0.683    0.035   19.474    0.000    0.683    0.849\n    RPA2              0.670    0.037   17.951    0.000    0.670    0.854\n    RPA3              0.623    0.040   15.403    0.000    0.623    0.788\n    RPA4              0.435    0.043   10.064    0.000    0.435    0.587\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n  TSC ~~                                                                \n    TE                0.659    0.045   14.688    0.000    0.659    0.659\n    EE                0.766    0.036   21.496    0.000    0.766    0.766\n    DE                0.564    0.060    9.374    0.000    0.564    0.564\n    RPA               0.686    0.037   18.725    0.000    0.686    0.686\n  TE ~~                                                                 \n    EE                0.689    0.041   16.816    0.000    0.689    0.689\n    DE                0.496    0.059    8.452    0.000    0.496    0.496\n    RPA               0.650    0.044   14.633    0.000    0.650    0.650\n  EE ~~                                                                 \n    DE                0.440    0.061    7.266    0.000    0.440    0.440\n    RPA               0.745    0.038   19.593    0.000    0.745    0.745\n  DE ~~                                                                 \n    RPA               0.340    0.059    5.742    0.000    0.340    0.340\n\nIntercepts:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n   .TSC1              3.662    0.031  117.614    0.000    3.662    5.620\n   .TSC2              3.813    0.030  128.595    0.000    3.813    6.145\n   .TSC3              3.719    0.030  123.332    0.000    3.719    5.893\n   .TSC5              3.861    0.032  120.631    0.000    3.861    5.764\n   .TE1               4.064    0.034  118.349    0.000    4.064    5.655\n   .TE2               4.048    0.033  121.772    0.000    4.048    5.818\n   .TE3               4.103    0.033  125.699    0.000    4.103    6.006\n   .TE5               3.934    0.035  111.433    0.000    3.934    5.324\n   .EE1               3.808    0.036  105.097    0.000    3.808    5.022\n   .EE2               3.751    0.040   94.879    0.000    3.751    4.533\n   .EE3               3.884    0.039   99.026    0.000    3.884    4.732\n   .EE4               3.710    0.038   96.396    0.000    3.710    4.606\n   .DE1               3.934    0.032  123.361    0.000    3.934    5.894\n   .DE2               3.600    0.033  108.034    0.000    3.600    5.162\n   .DE3               3.808    0.035  109.535    0.000    3.808    5.234\n   .RPA1              3.947    0.038  102.635    0.000    3.947    4.904\n   .RPA2              3.963    0.037  105.764    0.000    3.963    5.054\n   .RPA3              3.893    0.038  103.011    0.000    3.893    4.922\n   .RPA4              3.904    0.035  110.386    0.000    3.904    5.274\n\nVariances:\n                   Estimate  Std.Err  z-value  P(>|z|)   Std.lv  Std.all\n   .TSC1              0.242    0.019   12.538    0.000    0.242    0.569\n   .TSC2              0.201    0.020   10.143    0.000    0.201    0.521\n   .TSC3              0.241    0.018   13.075    0.000    0.241    0.605\n   .TSC5              0.212    0.020   10.661    0.000    0.212    0.473\n   .TE1               0.195    0.018   11.019    0.000    0.195    0.378\n   .TE2               0.215    0.020   10.979    0.000    0.215    0.444\n   .TE3               0.177    0.017   10.315    0.000    0.177    0.379\n   .TE5               0.316    0.029   11.033    0.000    0.316    0.579\n   .EE1               0.261    0.026   10.042    0.000    0.261    0.454\n   .EE2               0.244    0.024   10.013    0.000    0.244    0.356\n   .EE3               0.258    0.026    9.770    0.000    0.258    0.382\n   .EE4               0.274    0.029    9.610    0.000    0.274    0.423\n   .DE1               0.248    0.023   10.614    0.000    0.248    0.558\n   .DE2               0.288    0.023   12.766    0.000    0.288    0.591\n   .DE3               0.241    0.029    8.396    0.000    0.241    0.455\n   .RPA1              0.181    0.022    8.246    0.000    0.181    0.279\n   .RPA2              0.167    0.021    7.812    0.000    0.167    0.271\n   .RPA3              0.237    0.042    5.590    0.000    0.237    0.379\n   .RPA4              0.359    0.040    9.004    0.000    0.359    0.655\n    TSC               1.000                               1.000    1.000\n    TE                1.000                               1.000    1.000\n    EE                1.000                               1.000    1.000\n    DE                1.000                               1.000    1.000\n    RPA               1.000                               1.000    1.000\n```\n:::\n:::\n\n\n#### B) Parameters package\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(parameters)\nmodel_parameters(CFA.results.train, standardize = \"refit\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Loading\n\nLink        | Coefficient |   SE |       95% CI |     z |      p\n----------------------------------------------------------------\nTSC =~ TSC1 |        0.43 | 0.03 | [0.37, 0.49] | 14.61 | < .001\nTSC =~ TSC2 |        0.43 | 0.03 | [0.37, 0.48] | 15.32 | < .001\nTSC =~ TSC3 |        0.40 | 0.03 | [0.33, 0.46] | 11.91 | < .001\nTSC =~ TSC5 |        0.49 | 0.03 | [0.43, 0.54] | 16.49 | < .001\nTE =~ TE1   |        0.57 | 0.03 | [0.50, 0.63] | 16.51 | < .001\nTE =~ TE2   |        0.52 | 0.03 | [0.47, 0.57] | 19.36 | < .001\nTE =~ TE3   |        0.54 | 0.04 | [0.46, 0.61] | 13.88 | < .001\nTE =~ TE5   |        0.48 | 0.04 | [0.40, 0.56] | 11.77 | < .001\nEE =~ EE1   |        0.56 | 0.03 | [0.49, 0.63] | 16.05 | < .001\nEE =~ EE2   |        0.66 | 0.03 | [0.60, 0.73] | 19.88 | < .001\nEE =~ EE3   |        0.65 | 0.03 | [0.58, 0.71] | 18.49 | < .001\nEE =~ EE4   |        0.61 | 0.03 | [0.54, 0.68] | 17.70 | < .001\nDE =~ DE1   |        0.44 | 0.04 | [0.36, 0.53] | 10.59 | < .001\nDE =~ DE2   |        0.45 | 0.04 | [0.37, 0.52] | 11.16 | < .001\nDE =~ DE3   |        0.54 | 0.04 | [0.47, 0.61] | 14.75 | < .001\nRPA =~ RPA1 |        0.68 | 0.04 | [0.61, 0.75] | 19.47 | < .001\nRPA =~ RPA2 |        0.67 | 0.04 | [0.60, 0.74] | 17.95 | < .001\nRPA =~ RPA3 |        0.62 | 0.04 | [0.54, 0.70] | 15.40 | < .001\nRPA =~ RPA4 |        0.43 | 0.04 | [0.35, 0.52] | 10.06 | < .001\n\n# Correlation\n\nLink       | Coefficient |   SE |       95% CI |     z |      p\n---------------------------------------------------------------\nTSC ~~ TE  |        0.66 | 0.04 | [0.57, 0.75] | 14.69 | < .001\nTSC ~~ EE  |        0.77 | 0.04 | [0.70, 0.84] | 21.50 | < .001\nTSC ~~ DE  |        0.56 | 0.06 | [0.45, 0.68] |  9.37 | < .001\nTSC ~~ RPA |        0.69 | 0.04 | [0.61, 0.76] | 18.72 | < .001\nTE ~~ EE   |        0.69 | 0.04 | [0.61, 0.77] | 16.82 | < .001\nTE ~~ DE   |        0.50 | 0.06 | [0.38, 0.61] |  8.45 | < .001\nTE ~~ RPA  |        0.65 | 0.04 | [0.56, 0.74] | 14.63 | < .001\nEE ~~ DE   |        0.44 | 0.06 | [0.32, 0.56] |  7.27 | < .001\nEE ~~ RPA  |        0.74 | 0.04 | [0.67, 0.82] | 19.59 | < .001\nDE ~~ RPA  |        0.34 | 0.06 | [0.22, 0.46] |  5.74 | < .001\n```\n:::\n:::\n\n\n#### C) Grafico del analisis confirmatorio\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#install.packages(\"semPlot\") no sirve\n```\n:::\n\n:::\n\n### Analisis de ajuste\n\n#### Medidas de ajuste global\n\nPara ver el ajuste del modelo cfa hay medidas globales y locales, respecto de las globales se tienen las siguientes metricas que evaluan el ajuste y sus repectivas regla :\n\n-   CFI \\> 0.90 = buen ajuste.\n\n-   RMSEA \\< 0.08 = buen ajuste.\n\n-   SRMR \\< 0.08 = buen ajuste absoluto.\n\n#### semTools\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Resumen de los parámetros\n#inspect(CFA.results, \"std\")          # Cargas estandarizadas\n#inspect(CFA.results, \"cov.lv\")       # Covarianzas entre factores\n\n# Índices de ajuste\nsemTools::fitMeasures(CFA.results.train, c(\"cfi\", \"tli\", \"rmsea\", \"srmr\", \"aic\", \"bic\"))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      cfi       tli     rmsea      srmr       aic       bic \n    0.946     0.935     0.058     0.044 14688.751 14962.260 \n```\n:::\n\n```{.r .cell-code}\n# Fiabilidad compuesta y AVE\n#reliability(CFA.results.train)\n```\n:::\n\n\n#### Medidas de ajuste local\n\nHay varias medias, pero las mas pertinente corresponde a analizar la diferencia entre la matriz de varianza covarianza entre model-implied y la muestral\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(lavaan)\n\n\n# Obtener matriz de correlaciones observadas\nr_observed <- lavInspect(CFA.results.train, \"sampstat\")$cov\n\n# Obtener matriz de correlaciones reproducidas por el modelo\nr_model    <-  lavInspect(CFA.results.train, \"implied\")$cov\n\n# Calcular matriz de residuos estandarizados\nresidual_matrix <- r_observed - r_model\n\nprint(residual_matrix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       TSC1   TSC2   TSC3   TSC5    TE1    TE2    TE3    TE5    EE1    EE2\nTSC1  0.000                                                               \nTSC2 -0.012  0.000                                                        \nTSC3  0.007  0.012  0.000                                                 \nTSC5  0.007 -0.002 -0.010  0.000                                          \nTE1  -0.019  0.000 -0.009  0.010  0.000                                   \nTE2   0.025 -0.014 -0.031  0.021  0.011  0.000                            \nTE3   0.013 -0.010 -0.048 -0.005  0.003  0.008  0.000                     \nTE5   0.025  0.028  0.032  0.022 -0.012 -0.026 -0.005  0.000              \nEE1  -0.013  0.010  0.004 -0.016  0.042  0.044  0.001  0.072  0.000       \nEE2   0.004 -0.009  0.025 -0.003 -0.029 -0.050 -0.027  0.043 -0.002  0.000\nEE3  -0.013  0.015 -0.039  0.013 -0.021 -0.042 -0.006  0.081 -0.012 -0.001\nEE4  -0.002  0.002  0.000  0.013 -0.042  0.021  0.006  0.039 -0.017  0.017\nDE1  -0.011 -0.019  0.015  0.002  0.010 -0.026 -0.011  0.036 -0.010 -0.048\nDE2  -0.014  0.018  0.030 -0.011 -0.008 -0.025 -0.032  0.059  0.058  0.031\nDE3   0.000 -0.008  0.041 -0.021  0.023  0.006 -0.012  0.019  0.048 -0.015\nRPA1 -0.008  0.015 -0.034  0.011 -0.013 -0.022 -0.001  0.012  0.011 -0.018\nRPA2 -0.006 -0.008 -0.044  0.007 -0.021  0.004 -0.009  0.008  0.015 -0.016\nRPA3  0.041  0.016 -0.012  0.003 -0.006  0.010  0.017  0.034  0.035  0.008\nRPA4  0.020  0.000  0.003  0.031  0.001  0.027  0.031  0.039  0.042  0.035\n        EE3    EE4    DE1    DE2    DE3   RPA1   RPA2   RPA3   RPA4\nTSC1                                                               \nTSC2                                                               \nTSC3                                                               \nTSC5                                                               \nTE1                                                                \nTE2                                                                \nTE3                                                                \nTE5                                                                \nEE1                                                                \nEE2                                                                \nEE3   0.000                                                        \nEE4   0.010  0.000                                                 \nDE1  -0.042 -0.040  0.000                                          \nDE2   0.012  0.052  0.004  0.000                                   \nDE3  -0.022  0.012  0.002 -0.006  0.000                            \nRPA1  0.019 -0.041 -0.008 -0.006  0.002  0.000                     \nRPA2 -0.002 -0.053 -0.010 -0.025 -0.024  0.024  0.000              \nRPA3  0.022 -0.009  0.002  0.016  0.021 -0.009 -0.017  0.000       \nRPA4  0.031  0.053  0.006  0.056  0.074 -0.046 -0.011  0.052  0.000\n```\n:::\n\n```{.r .cell-code}\nmax(residual_matrix)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.08051991\n```\n:::\n:::\n\n\n### Evaluar la generabilidad\n\n-   si el modelo ajusta bien tambien en el conjunto de datos de entrenamiento, puedes estar seguro que el modelo realmente captura bien la estructura factorial subyacente\n\n\n::: {.cell}\n\n```{.r .cell-code}\nCFA.results.test <- cfa(model        = CFA_model,\n                       data          = db_test,\n                       estimator     = \"MLR\",\n                       std.lv        = TRUE,\n                       meanstructure = TRUE)\n```\n:::\n",
    "supporting": [
      "analisis-confirmatorio_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}